name: VMware_vCenter_file_upload__CVE_2021_22005
transport: http
set: {}
detail:
  dock: body="VMware vSphere is virtual"
  product: Vmware VCenter
  homepage: https://www.vmware.com/products/vcenter-server.html
  impact: <p>VMware vCenter Server has arbitrary file upload vulnerabilities. Attackers
    can upload specially crafted files through port 443 of VMware vCenter Server and
    execute arbitrary code on vCenter Server.</p>
  description: <p>VMware vCenter Server is a set of server and virtualization management
    software from Vmware. The software provides a centralized platform for managing
    VMware vSphere environments, which can automatically implement and deliver virtual
    infrastructure.</p><p>VMware vCenter Server has arbitrary file upload vulnerabilities.
    Attackers can upload specially crafted files through port 443 of VMware vCenter
    Server and execute arbitrary code on vCenter Server.</p>
rules:
  r1:
    method: POST
    path: /analytics/telemetry/ph/api/hyper/send?_c&_i=test
    follow_redirects: false
    headers:
      Content-Type: application/json
    body: test
    expression: response.status == 201
  r2:
    method: POST
    path: /analytics/ph/api/dataapp/agent?_c=test&_i=1
    follow_redirects: false
    headers:
      Content-Type: application/json
    body: "{}"
    expression: response.status == 201
  r3:
    method: POST
    path: /analytics/ph/api/dataapp/agent?action=collect&_c=test&_i=1
    follow_redirects: false
    headers:
      Content-Type: application/json
    body: "{}"
    expression: response.status == 200
    
expression: r1() || r2() || r3()
