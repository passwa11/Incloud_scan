name: Consul_Rexec_RCE
transport: http
set: {}
detail:
  dock: protocol="consul(http)"
  product: Consul
  homepage: https://www.consul.io/
  impact: Under a specific configuration, a malicious attacker can remotely execute
    commands on the Consul server without authorization by sending a carefully constructed
    HTTP request.
  description: Consul is the control plane of the service mesh. Consul is a multi-networking
    tool that offers a fully-featured service mesh solution that solves the networking
    and security challenges of operating microservices and cloud infrastructure.
rules:
  r1:
    method: GET
    path: /v1/agent/self
    follow_redirects: false
    expression: response.status == 200 && response.body.bcontains(b'"DisableRemoteExec":false')
expression: r1()
