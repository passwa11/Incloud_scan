name: Docker_Registry_API_Unauth
transport: http
set: {}
detail:
  dock: header="registry/2.0"
  product: Docker Registry
  homepage: https://docs.docker.com/registry/
  impact: There is an unauthorized access vulnerability in the Docker Registry API.
    Docker images can be downloaded through the API, resulting in the disclosure of
    sensitive information.
  description: Docker is a set of platform as a service products that use OS-level
    virtualization to deliver software in packages called containers.
rules:
  r1:
    method: GET
    path: /v2/
    follow_redirects: false
    expression: response.status == 200 && response.raw_header.bcontains(b'docker-distribution-api-version')
      && response.raw_header.bcontains(b'registry/2.0')
  r2:
    method: GET
    path: /v2/_catalog
    follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b'repositories')
expression: r1() && r2()
